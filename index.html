<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Nox Studio Ultimate</title>
<style>
body{margin:0;font-family:Arial;background:linear-gradient(135deg,#1f1c2c,#928dab);color:white}
header{text-align:center;padding:20px;background:black}
button{padding:6px 12px;border:none;border-radius:8px;margin:4px;font-weight:bold;cursor:pointer}
button:hover{opacity:.8}
.section{background:rgba(0,0,0,.5);margin:15px;padding:15px;border-radius:15px}
video{width:100%;border-radius:12px;margin-top:10px;transition:.3s}
textarea,input{width:100%;padding:6px;border-radius:6px;border:none;margin-top:5px}
.post{background:#00000090;padding:10px;margin-top:10px;border-radius:10px}
.comment{background:#000000aa;padding:5px;margin-top:5px;border-radius:6px}
.textOverlay{position:absolute;color:white;font-size:30px;font-weight:bold;text-shadow:0 0 10px black}
</style>
</head>
<body>

<header>
<h2>Nox Studio Ultimate</h2>
<div id="userInfo"></div>
<button onclick="openLogin()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
<button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
</header>

<div class="section">
<h3>ğŸ“¤ Ø±ÙØ¹ ÙÙŠØ¯ÙŠÙˆ</h3>
<input type="file" accept="video/*" onchange="loadVideo(event)">
<div style="position:relative">
<video id="video" controls></video>
<div id="overlay" class="textOverlay"></div>
</div>
<textarea id="desc" placeholder="ÙˆØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ"></textarea>

<h3>ğŸ¨ Ø§Ù„ÙÙ„Ø§ØªØ±</h3>
<button onclick="applyFilter('none')">Ø¹Ø§Ø¯ÙŠ</button>
<button onclick="applyFilter('cinematic')">Ø³ÙŠÙ†Ù…Ø§Ø¦ÙŠ</button>
<button onclick="applyFilter('vintage')">Vintage</button>
<button onclick="applyFilter('noir')">Ø£Ø¨ÙŠØ¶ ÙˆØ£Ø³ÙˆØ¯</button>
<button onclick="applyFilter('neon')">Ù†ÙŠÙˆÙ†</button>
<button onclick="applyFilter('anime')">Ø£Ù†Ù…ÙŠ</button>
<button onclick="applyFilter('bright')">Ù…Ø´Ø±Ù‚</button>
<button onclick="applyFilter('dark')">Ø¯Ø§ÙƒÙ†</button>

<h3>âš¡ Ø§Ù„Ø­Ø±ÙƒØ©</h3>
<button onclick="zoom(1.2)">Zoom+</button>
<button onclick="zoom(1)">Reset Zoom</button>
<button onclick="rotate()">ØªØ¯ÙˆÙŠØ±</button>
<button onclick="shake()">Ø§Ù‡ØªØ²Ø§Ø²</button>

<h3>â±ï¸ Ø³Ø±Ø¹Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</h3>
<button onclick="speed(.5)">Ø¨Ø·ÙŠØ¡</button>
<button onclick="speed(1)">Ø¹Ø§Ø¯ÙŠ</button>
<button onclick="speed(1.5)">Ø³Ø±ÙŠØ¹</button>

<h3>ğŸ“ Ù†Øµ Ù…ØªØ­Ø±Ùƒ Ø¹Ù„Ù‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</h3>
<input id="textInput" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ">
<button onclick="addText()">Ø¥Ø¶Ø§ÙØ© Ù†Øµ</button>

<br><br>
<button onclick="publish()">Ù†Ø´Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>
</div>

<div class="section">
<h3>ğŸ¥ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©</h3>
<div id="posts"></div>
</div>

<div id="loginBox" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#000000d0;justify-content:center;align-items:center">
<div style="background:#111;padding:20px;border-radius:15px;width:280px">
<input id="uid" placeholder="Ø§Ù„Ù…Ø¹Ø±Ù">
<input id="pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button onclick="register()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
<button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
<button onclick="closeLogin()">Ø¥ØºÙ„Ø§Ù‚</button>
</div>
</div>

<script>
let users=JSON.parse(localStorage.getItem("users"))||[]
let currentUser=JSON.parse(localStorage.getItem("currentUser"))||null
let rotation=0
let db

const request=indexedDB.open("NoxDB",1)
request.onupgradeneeded=e=>{
 db=e.target.result
 db.createObjectStore("videos",{keyPath:"id"})
}
request.onsuccess=e=>{
 db=e.target.result
 render()
}

function openLogin(){loginBox.style.display="flex"}
function closeLogin(){loginBox.style.display="none"}

function register(){
if(!uid.value||!pass.value)return alert("Ø¹Ø¨ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")
if(users.find(u=>u.id==uid.value))return alert("Ø§Ù„Ù…Ø¹Ø±Ù Ù…Ø³ØªØ®Ø¯Ù…")
users.push({id:uid.value,pass:pass.value})
localStorage.setItem("users",JSON.stringify(users))
alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨")
}

function login(){
let user=users.find(u=>u.id==uid.value&&u.pass==pass.value)
if(user){
 currentUser=user.id
 localStorage.setItem("currentUser",JSON.stringify(currentUser))
 updateUI()
 closeLogin()
}else alert("Ø¨ÙŠØ§Ù†Ø§Øª ØºÙ„Ø·")
}

function logout(){
 currentUser=null
 localStorage.removeItem("currentUser")
 updateUI()
}

function updateUI(){
 userInfo.innerHTML=currentUser?"Ù…Ø³Ø¬Ù„: "+currentUser:"ØºÙŠØ± Ù…Ø³Ø¬Ù„"
}

// ÙÙŠØ¯ÙŠÙˆ
function loadVideo(e){
 let file=e.target.files[0]
 let reader=new FileReader()
 reader.onload=function(){
   video.src=reader.result
   video.dataset.data=reader.result
 }
 reader.readAsDataURL(file)
}

// ÙÙ„Ø§ØªØ±
function applyFilter(type){
 switch(type){
   case'none':video.style.filter="none";break;
   case'cinematic':video.style.filter="contrast(120%) brightness(90%) sepia(30%)";break;
   case'vintage':video.style.filter="sepia(60%) contrast(110%)";break;
   case'noir':video.style.filter="grayscale(100%) contrast(140%)";break;
   case'neon':video.style.filter="hue-rotate(90deg) saturate(200%)";break;
   case'anime':video.style.filter="contrast(130%) saturate(180%) hue-rotate(10deg)";break;
   case'bright':video.style.filter="brightness(130%)";break;
   case'dark':video.style.filter="brightness(60%)";break;
 }
}

// Ø­Ø±ÙƒØ©
function zoom(val){video.style.transform="scale("+val+") rotate("+rotation+"deg)"}
function rotate(){rotation+=90;video.style.transform="rotate("+rotation+"deg)"}
function shake(){video.style.animation="shake .3s";setTimeout(()=>video.style.animation="",300)}
function speed(s){video.playbackRate=s}

// Ù†Øµ
function addText(){overlay.innerText=textInput.value;overlay.style.top="40%";overlay.style.left="30%"}

// Ø­ÙØ¸ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… IndexedDB
function saveVideoData(data){
 let tx=db.transaction("videos","readwrite")
 tx.objectStore("videos").put(data)
}

function getAllVideos(callback){
 let tx=db.transaction("videos","readonly")
 let store=tx.objectStore("videos")
 let req=store.getAll()
 req.onsuccess=()=>callback(req.result)
}

function deleteVideo(id){
 let tx=db.transaction("videos","readwrite")
 tx.objectStore("videos").delete(id)
 render()
}

function publish(){
 if(!currentUser)return alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙŠØ¬Ø¨ Ø£Ù† ØªØ³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ âŒ")
 if(!video.dataset.data)return alert("Ø§Ø±ÙØ¹ ÙÙŠØ¯ÙŠÙˆ")
 let post={id:Date.now(),user:currentUser,video:video.dataset.data,desc:desc.value,comments:[]}
 saveVideoData(post)
 render()
}

// Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
function render(){
 if(!db)return
 getAllVideos(data=>{
   posts.innerHTML=""
   data.forEach(p=>{
     let div=document.createElement("div")
     div.className="post"
     let del=p.user==currentUser?`<button onclick="deleteVideo(${p.id})">Ø­Ø°Ù</button>`:""
     div.innerHTML=`
       <video src="${p.video}" controls></video>
       <p>${p.desc}</p>
       ${del}
       <textarea id="c${p.id}" placeholder="ØªØ¹Ù„ÙŠÙ‚"></textarea>
       <button onclick="comment(${p.id})">Ø¥Ø±Ø³Ø§Ù„</button>
       <div id="com${p.id}"></div>
     `
     posts.appendChild(div)
     p.comments.forEach((c,i)=>{
       document.getElementById("com"+p.id).innerHTML+=`
         <div class="comment">${c} ${p.user==currentUser?`<button onclick="delComment(${p.id},${i})">Ø­Ø°Ù</button>`:""}</div>`
     })
   })
 })
}

// Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
function comment(id){
 if(!currentUser)return alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ ÙŠØ¬Ø¨ Ø£Ù† ØªØ³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ âŒ")
 let text=document.getElementById("c"+id).value
 if(!text)return
 let post
 getAllVideos(data=>{post=data.find(p=>p.id==id);post.comments.push(text);saveVideoData(post);render()})
}

function delComment(pid,i){
 getAllVideos(data=>{
   let post=data.find(p=>p.id==pid)
   post.comments.splice(i,1)
   saveVideoData(post)
   render()
 })
}
</script>

<style>
@keyframes shake{
0%{transform:translateX(0)}
25%{transform:translateX(-5px)}
50%{transform:translateX(5px)}
75%{transform:translateX(-5px)}
100%{transform:translateX(0)}
}
</style>

</body>
</html>
